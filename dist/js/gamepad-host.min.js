!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.gamepad=e()}}(function(){return function e(t,n,o){function r(s,c){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!c&&l)return l(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return r(n?n:e)},u,u.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t){!function(n,o){"use strict";function r(e){u=this,e||(e={}),Object.keys(d).forEach(function(t){this[t]=t in e?e[t]:d[t]}.bind(this)),this.eventEmitter=new r.EventEmitter,this.state={}}var i=e("./lib/modal")(n,o),s=e("./settings"),c=e("./lib/utils")(n,o),l=c.error,a=c.trace;c.polyfill();var u,d={protocol:"webrtc"},f={get:function(){return u},init:function(e){return u||new r({protocol:e})}};r.version=s.VERSION,r.prototype._handshake=function(e){return new Promise(function(t){e||(e=c.getPeerId());var o=new n.Peer(e,{key:s.PEERJS_KEY,debug:s.DEBUG?3:0});n.addEventListener("beforeunload",function(){o.destroy()}),o.on("open",function(){a("My peer ID: "+o.id),t(o)})})},r.prototype._connect=function(e){return new Promise(function(t,n){e.on("connection",function(e){e.on("data",function(e){switch(e.type){case"state":f._updateState(e.data);break;default:console.warn('WebRTC message received of unknown type: "'+e.type+'"')}a("Received: "+("object"==typeof e?JSON.stringify(e):""))}),e.on("error",function(e){l(e.message),n(e)}),t(e)})})},r.prototype.pair=function(e){return new Promise(function(t){return f._handshake(e).then(function(e){var t=e.id,o=encodeURIComponent(t),r=p+"/client.html?"+o;n.history.replaceState(null,null,n.location.pathname+"?"+o);var s='<div class="modal-inner modal-pair"><h2>URL</h2><p><a href="'+r+'" class="pair-url" target="_blank">'+r+'</a></p><h2>Code</h2><p class="pair-code">'+o+"</p></div>";return this.modal=new i({id:"pairing-screen",classes:"slim",title:"Pair your mobile phone",content:s},!0),n.setTimeout(function(){this.modal.open()},150),["https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700","/css/modal.css"].forEach(function(e){c.injectCSS({href:e})}),f.connect(e)}.bind(this)).then(function(e){console.log("Peer connected"),this.modal.close(),t(e)}.bind(this)).catch(console.error.bind(console))}.bind(this))},r.prototype._updateState=function(e){e||(e={}),Object.keys(e).forEach(function(t){!this.state[t]&&e[t]?(f._emit("buttondown",t),f._emit("buttondown."+t,t)):this.state[t]&&!e[t]&&(f._emit("buttonup",t),f._emit("buttonup."+t,t))}.bind(this)),this.state=e},r.prototype.hidePairingScreen=function(){this.modal.close()},r.prototype.on=function(){var e=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,e)},r.prototype.off=function(e,t){return this.eventEmitter.removeListener(e,t)},r.EventEmitter=function(){this.events={}},r.EventEmitter.prototype.addListener=function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),n=e;if("function"!=typeof t)throw new TypeError("Last argument must be a function");n.forEach(function(e){this.hasHandler(e)?this.events[e].push(t):this.events[e]=[t]},this)},r.EventEmitter.prototype.removeListener=function(e,t){if(this.hasHandler(e)){var n=this.events[e].indexOf(t);this.events[e].splice(n,1),this.events[e].length||delete this.events[e]}},r.EventEmitter.prototype.emit=function(e){if(this.hasHandler(e)){var t=Array.prototype.slice.call(arguments,1);this.events[e].forEach(function(e){e.apply(void 0,t)})}},r.EventEmitter.prototype.hasHandler=function(e){return e in this.events};var p=n.location.origin,m=o.querySelector("[data-galaxy-origin]");m&&(r.galaxyOrigin=m.dataset.galaxyOrigin),t.exports=f}(window,document)},{"./lib/modal":2,"./lib/utils":3,"./settings":4}],2:[function(e,t){t.exports=function(t,n){"use strict";function o(e,t){Object.keys(e).forEach(function(t){this[t]=e[t]}.bind(this)),t&&this.inject()}var r=e("./utils");return o.closeAll=o.prototype.close=function(){return new Promise(function(e,t){var o=n.querySelector(".md-show");return o?(o.classList.remove("md-show"),setTimeout(function(){n.body.classList.remove("galaxy-overlayed"),e()},150),void 0):t()})},o.injectOverlay=function(){if(!n.querySelector(".md-overlay")){var e=n.createElement("div");e.className="md-overlay",n.body.appendChild(e)}},o.prototype.html=function(){var e=n.createElement("div");return e.id="modal-"+this.id,e.className="md-modal md-effect-1 "+(this.classes||""),e.style.display="none",e.innerHTML='<div class="md-content"><h3>'+r.escape(this.title)+'</h3> <a class="md-close" title="Close"><span><div>Close</div></span></a><div>'+this.content+"</div></div>",e},o.prototype.inject=function(){return o.injectOverlay(),this.el=this.html(),this.el.style.display="block",n.body.appendChild(this.el),n.body.classList.add("galaxy-overlayed"),this.el},o.prototype.open=function(){this.el.classList.add("md-show")},o}},{"./utils":3}],3:[function(e,t){t.exports=function(e,t){"use strict";function n(t,n){console[n||"log"]((e.performance.now()/1e3).toFixed(3)+": "+t)}function o(e){return n(e,"error")}function r(e){return n(e,"warn")}function i(){"performance"in e||(e.performance={now:function(){return+new Date}}),"origin"in e.location&&(e.location.origin=e.location.protocol+"//"+e.location.host)}function s(){return e.location.pathname.indexOf(".html")?e.location.search.substr(1):e.location.pathname.substr(1)}function c(e){return-1!==h.indexOf(e.target.nodeName.toLowerCase())}function l(){return"ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch}function a(e){var n=t.createElement("link");n.href=e.href,n.media="all",n.rel="stylesheet",n.type="text/css",Object.keys(e||{}).forEach(function(t){n[t]=e[t]}),t.querySelector("head").appendChild(n)}function u(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&#34;"):e}function d(){return!(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)}function f(){d()?(n("Entering full screen"),t.documentElement.requestFullscreen?t.documentElement.requestFullscreen():t.documentElement.mozRequestFullScreen?t.documentElement.mozRequestFullScreen():t.documentElement.webkitRequestFullscreen?t.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):t.documentElement.msRequestFullscreen&&t.documentElement.msRequestFullscreen()):(n("Exiting full screen"),t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.msExitFullscreen&&t.msExitFullscreen())}function p(t){var n=e.screen.LockOrientation||e.screen.mozLockOrientation||e.screen.webkitLockOrientation||e.screen.msLockOrientation;return n?n(t):r("Orientation could not be locked")}function m(n){var o=t.createEvent("HTMLEvents");o.initEvent(n,!0,!0),o.eventName=n,(t.body||e).dispatchEvent(o)}if(!e)throw new Error("window required");if(!t)throw new Error("document required");var h=["input","keygen","meter","option","output","progress","select","textarea"];return{trace:n,error:o,warn:r,polyfill:i,getPeerId:s,fieldFocused:c,hasTouchEvents:l,injectCSS:a,escape:u,isFullScreen:d,toggleFullScreen:f,lockOrientation:p,triggerEvent:m}}},{}],4:[function(e,t){"use strict";var n={};try{n=e("./settings_local.js")}catch(o){}var r={API_URL:"http://localhost:5000",DEBUG:!1,PEERJS_KEY:"",VERSION:"0.0.1"};Object.keys(n).forEach(function(e){r[e]=n[e]}),t.exports=r},{"./settings_local.js":5}],5:[function(e,t){t.exports={DEBUG:!0,PEERJS_KEY:"rovu5xmqo69wwmi"}},{}]},{},[1])(1)});